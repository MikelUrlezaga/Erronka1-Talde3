<!DOCTYPE html>
    <head>
        <meta charset="UTF-8">
        <script src="../../script/menu.js" ></script>
        <link rel="stylesheet" href="../../CSS/styles.css">
        <link rel="icon" href="../../IMG/LOGO.png" type="image/x-icon">
        <title >Gelak Eguneratu</title>
    </head>
    <header>
            <img class="logo" src="../../IMG/LOGO.png">
            <p id="titulo" class="titulo">GELAK EGUNERATU</p>
            <div class="headerdiv">
                <a href="Taula.html">
                    <img class="headerimg" src="../../IMG/arrow.png">
                </a>
                <p>&nbsp;</p>
                <a href="../../HTML/Orokorra/Login.html">
                    <img class="headerimg" src="../../IMG/LogOut.png">
                </a>
            </div>
    </header>
    <body>
        <div class="reborde">
                <div class="custom-combobox">
                    <select id="selector">
                        <option value="opcion1">Opción 1</option>
                        <option value="opcion2">Opción 2</option>
                        <option value="opcion3">Opción 3</option>
                        <option value="opcion4">Opción 4</option>
                    </select>
                </div>
                <p class="texto1Columna">Izena: </p>
                <input class="textBox1Columna" type="text" id="izenaGelakEgu" name="Izena">
                <p class="texto1Columna">Taldea: </p>
                <input class="textBox1Columna" type="text" id="taldeaGelakEgu" name="Taldea">
                <div class="ck">
                    <img src="../../IMG/unnamed.png" alt="check" class="checkicon">
                </div>
        </div>
    </body>
    <div id="menuMugikorra"></div>

</html>
<script>
    var paramstr = window.location.search.substr(1);
    console.log(window.location.search.substr(1));
    var paramarr = paramstr.split ("&");
    var params = {};
    var nuestraId=0;
    
    for ( var i = 0; i < paramarr.length; i++) {
        var tmparr = paramarr[i].split("=");
        params[tmparr[0]] = tmparr[1];
        console.log(tmparr[1]);
        nuestraId=tmparr[1];
    }

    async function bistaratuFromPHP2() {
        var ida = JSON.stringify(nuestraId);
        let options = {method: "GET", url: ida};
        fetch("../../PHP/gelak_json.php",options)
            .then(response => response.json())  // Analiza la respuesta JSON
            .then(data => {
                console.log(data);
                console.log(data.length);
                document.getElementById("izenaGelakEgu").value=data[0].izena;
                document.getElementById("taldeaGelakEgu").value=data[0].taldea;
                document.getElementById("titulo").innerText= data[0].izena + " Gela eguneratu";
            })
            .catch(error => {
                alert("Errorea." + error);
            });
    }

    async function bistaratuFromPHP() {
        let options = {method: "GET"};
        fetch("../../PHP/gelak_json.php",options)
            .then(response => response.json())  // Analiza la respuesta JSON
            .then(data => {
                console.log(data);
                console.log(data.length);
                var selector = document.getElementById("selector")[0];
                for (let i = 0; i < data.length; i++) {
                    var opcion = document.createElement("option");
                    opcion.text = data[i].izena;
                    // Añadimos un value a los option para hacer mas facil escoger los pueblos
                    opcion.value = data[i].izena.toLowerCase()
                    selector.add(opcion);
                    
                }
            })
            .catch(error => {
                alert("Errorea." + error);
            });
    }
    window.addEventListener("load", bistaratuFromPHP);
    window.addEventListener("load", bistaratuFromPHP2);
</script>